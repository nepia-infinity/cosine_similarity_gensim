# 🐍 Pythonのバージョンについて
- ja_ginza_electra が Pythonの3.13に対応していない
- Python 3.11、ダウングレードして仮想環境を作成

```
py -3.11 -m venv .venv
```
# 💡 GiNZAを採用する理由
- 日本語の文章を「単語」や「品詞」に分ける処理を形態素解析と呼びます。
- 最新のTransformerベースモデル（ELECTRA）を採用
- 固有表現抽出（人名・組織名など）に強い

# ✅ コサイン類似度とは？

- 「今日の天気は晴れです」
- 「外はとてもいい天気ですね」

この2つの文は使っている単語は違いますが、意味は似ています。
コンピュータは文章や言葉を、「ベクトル（数の並び）」として扱います。
コサイン類似度は、これらを「意味の方向」で比べてどのくらい似ているか（1に近いほど似ている）を数値で教えてくれます。

このPythonスクリプトは、**Doc2Vec（Gensimライブラリ）とGiNZA（spaCyライブラリ）を使用して、CSVファイル内の文書群と指定したクエリ文との類似度を計算し、最も類似している文書の上位5件をランキング表示する**ものです。

具体的には、CSVから読み込んだ各文書をGiNZAで形態素解析（単語に分割）し、それを使ってDoc2Vecモデルを学習させます。その後、入力されたクエリ文のベクトルを推論し、学習済みの全文書ベクトルとコサイン類似度を比較しています。

---

# 💻 test_gensimについて

以下に、それぞれの関数が何をしているかをまとめます。

* **`load_data(file_path)`**
    * **働き:** 指定されたCSVファイル（`data_file`）を読み込み、PandasのDataFrameとして返します。
* **`tokenize_data(data)`**
    * **働き:** DataFrame内の全文書（`text`列）に対し、GiNZAを使って形態素解析を行います。名詞、動詞、形容詞、副詞のみを抽出し、Doc2Vecの学習に必要な「`TaggedDocument`」という形式のリストを作成します。
* **`train_doc2vec_model(tagged_data)`**
    * **働き:** `tokenize_data`で作成した`TaggedDocument`のリストを使い、Doc2Vecモデルを学習させます。学習済みのモデルを返します。
* **`tokenize_data_single(text)`**
    * **働き:** （主にクエリ文などの）単一のテキストを形態素解析し、トークン（単語）のリストを返します。
* **`calculate_similarity_and_rank(model, data, query)`**
    * **働き:** 学習済みモデル（`model`）とクエリ文（`query`）を使って、以下の処理を行います。
        1.  クエリ文からベクトルを推論します。
        2.  学習データ（`data`）内の全文書のベクトルをモデルから取得します。
        3.  クエリベクトルと全文書ベクトルのコサイン類似度を計算します。
        4.  類似度が高い順に並び替え、上位5件の結果を辞書のリスト（配列）として返します。
* **`print_results(top_5_results_array)`**
    * **働き:** `calculate_similarity_and_rank`が返した上位5件の結果リストを受け取り、コンソールに見やすく整形して出力します。
* **`if __name__ == "__main__":` ブロック**
    * **働き:** このスクリプトが直接実行されたときに、上記の関数を順番に呼び出し、データ読み込みからモデル学習、類似度計算、結果表示までの一連の処理を実行します。

## 🔑 検索クエリ
```
プログラミングはとても面白いです。Pythonが好き。
```

### ✅ 検索クエリとコサイン類似度が近い文章の判定結果

| Row_Index | Document                                         | Similarity |
|------------|--------------------------------------------------|-------------|
| 105 | Pythonが好きで、最近は自動化スクリプトを書いています。 | 0.375241 |
| 201 | Pythonはシンプルで読みやすいので初心者にも人気があります。 | 0.352265 |
| 47  | 営業目標を達成するために努力しています。 | 0.284813 |
| 59  | 定期的な健康診断を受けることが大切です。 | 0.278449 |
| 104 | gensimのDoc2Vecを使うと文章をベクトルに変換できます。 | 0.239443 |

- Pythonという単語にまったく関係のないもののコサイン類似度が高いと出力される。
- この学習モデルは失敗
- 100件の検索結果では、モデルに十分なデータが足りず性能が発揮できなかった可能性が高い。

# ⚡ LightGBM
- LightGBM（Light Gradient Boosting Machine）は、Microsoft が開発した勾配ブースティングアルゴリズムの高速実装ライブラリです。
- 大規模データや高次元データでも高速に学習でき、特徴量の重要度分析や分類・回帰タスクでよく使われます。

# 💬 Gensim
- Gensim は自然言語処理（NLP）向けのライブラリで、特に「文書のベクトル化」や「類似度計算」に強みがあります。
- Word2Vec、Doc2Vec、TF-IDF、LDAなどのモデルを簡単に利用でき、文章間の意味的な距離（コサイン類似度など）を計算するのに適しています。

# 🧩 Scikit-learn
- Scikit-learn は Python の代表的な機械学習ライブラリで、分類・回帰・クラスタリング・前処理などの機能が統合されています。
- LightGBM や Gensim で生成した特徴量を使って、さらに統計的モデルや機械学習モデルを構築するのに便利です。